{"mappings":"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","sources":["<anon>","public/js/index.js","public/js/leaflet.js","public/js/login.js","public/js/alerts.js","public/js/stripe.js","public/js/updateSettings.js"],"sourcesContent":["/* eslint-disable */ /* eslint-disable */ const $eb9b3d82609c297a$export$4c5dd147b21b9176 = (locations)=>{\n    const map = L.map('map', {\n        zoomControl: false,\n        scrollWheelZoom: true,\n        doubleClickZoom: false,\n        dragging: true\n    });\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    }).addTo(map);\n    const greenIcon = L.icon({\n        iconUrl: '/img/pin.png',\n        iconSize: [\n            32,\n            40\n        ],\n        iconAnchor: [\n            16,\n            45\n        ],\n        popupAnchor: [\n            0,\n            -50\n        ]\n    });\n    const points = [];\n    locations.forEach((loc)=>{\n        points.push([\n            loc.coordinates[1],\n            loc.coordinates[0]\n        ]);\n        L.marker([\n            loc.coordinates[1],\n            loc.coordinates[0]\n        ], {\n            icon: greenIcon\n        }).addTo(map).bindPopup(`<p>Day ${loc.day}: ${loc.description}</p>`, {\n            autoClose: false,\n            className: 'mapPopup'\n        }).on('mouseover', function(e) {\n            this.openPopup();\n        }).on('mouseout', function(e) {\n            this.closePopup();\n        }).openPopup();\n    });\n    const bounds = L.latLngBounds(points).pad(0.5);\n    map.fitBounds(bounds);\n};\n\n\n/* eslint-disable */ /* eslint-disable */ const $1b898bf38035b943$export$516836c6a9dfc573 = ()=>{\n    const el = document.querySelector('.alert');\n    if (el) el.parentElement.removeChild(el);\n};\nconst $1b898bf38035b943$export$de026b00723010c1 = (type, msg)=>{\n    $1b898bf38035b943$export$516836c6a9dfc573();\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n    window.setTimeout($1b898bf38035b943$export$516836c6a9dfc573, 5000);\n};\n\n\nconst $c3c64160fa6c26e4$export$596d806903d1f59e = async (email, password)=>{\n    try {\n        const res = await axios.post('/api/v1/users/login', {\n            email: email,\n            password: password\n        });\n        if (res.data.status === 'success') {\n            (0, $1b898bf38035b943$export$de026b00723010c1)('success', 'Logged in successfully!');\n            window.setTimeout(()=>window.location.href = '/', 500);\n        }\n    } catch (err) {\n        (0, $1b898bf38035b943$export$de026b00723010c1)('error', err.response.data.message);\n    }\n};\nconst $c3c64160fa6c26e4$export$a0973bcfe11b05c9 = async ()=>{\n    try {\n        const res = await axios.get('/api/v1/users/logout');\n        res.data.status = 'success';\n        location.assign('/');\n    } catch (err) {\n        (0, $1b898bf38035b943$export$de026b00723010c1)('error', 'Error logging out! Try again.');\n    }\n};\n\n\n/*eslint-disable*/ \nconst $bd6da4746eaeec83$export$8d5bdbf26681c0c2 = async (tourId)=>{\n    try {\n        const res = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n        const { url: url } = res.data.session;\n        if (res.data.status === 'success') window.location.href = url;\n        else (0, $1b898bf38035b943$export$de026b00723010c1)('error', 'Invalid session or missing URL');\n    } catch (err) {\n        (0, $1b898bf38035b943$export$de026b00723010c1)('error', 'Error Checking out');\n    }\n};\n\n\n/* eslint-disable */ \nconst $3ed33bdc2a0cf15d$export$f558026a994b6051 = async (data, type)=>{\n    try {\n        const url = type === 'password' ? '/api/v1/users/update-password' : '/api/v1/users/update-user';\n        const res = await axios.patch(url, data);\n        if (res.data.status === 'success') (0, $1b898bf38035b943$export$de026b00723010c1)('success', `${type.toUpperCase()} updated successfully!`);\n    } catch (err) {\n        (0, $1b898bf38035b943$export$de026b00723010c1)('error', err.response.data.message);\n    }\n};\n\n\nconst $9abd65d1c0e6ac42$var$init = ()=>{\n    // Iinit map\n    const map = document.getElementById('map');\n    const userLoginForm = document.querySelector('.user-login-form');\n    const logoutBtn = document.querySelector('.nav__el--logout');\n    const userDataForm = document.querySelector('.form-user-data');\n    const userPasswordForm = document.querySelector('.form-user-settings');\n    const bookTourBtn = document.querySelector('#book-tour');\n    if (map) {\n        const locations = JSON.parse(map.dataset.locations);\n        (0, $eb9b3d82609c297a$export$4c5dd147b21b9176)(locations);\n    }\n    // Login\n    if (userLoginForm) userLoginForm.addEventListener('submit', (e)=>{\n        e.preventDefault();\n        const email = document.querySelector('#email').value;\n        const password = document.querySelector('#password').value;\n        (0, $c3c64160fa6c26e4$export$596d806903d1f59e)(email, password);\n    });\n    // Lgout\n    if (logoutBtn) logoutBtn.addEventListener('click', ()=>{\n        (0, $c3c64160fa6c26e4$export$a0973bcfe11b05c9)();\n    });\n    // updata user settings\n    if (userDataForm) userDataForm.addEventListener('submit', async (e)=>{\n        e.preventDefault();\n        const form = new FormData();\n        form.append('name', document.getElementById('name').value);\n        form.append('email', document.getElementById('email').value);\n        form.append('photo', document.getElementById('photo').files[0]);\n        document.querySelector('.btn--save-settings').textContent = 'Updating...';\n        await (0, $3ed33bdc2a0cf15d$export$f558026a994b6051)(form, 'data');\n        document.querySelector('.btn--save-settings').textContent = 'Save settings';\n    });\n    if (userPasswordForm) userPasswordForm.addEventListener('submit', async (e)=>{\n        e.preventDefault();\n        userPasswordForm.querySelector('.btn--save-password').textContent = 'Updating...';\n        const passwordCurrent = userPasswordForm.querySelector('#password-current').value;\n        const password = userPasswordForm.querySelector('#password').value;\n        const passwordConfirm = userPasswordForm.querySelector('#password-confirm').value;\n        await (0, $3ed33bdc2a0cf15d$export$f558026a994b6051)({\n            passwordCurrent: passwordCurrent,\n            password: password,\n            passwordConfirm: passwordConfirm\n        }, 'password');\n        userPasswordForm.querySelector('.btn--save-password').textContent = 'Save password';\n        userPasswordForm.querySelector('#password-current').value = '';\n        userPasswordForm.querySelector('#password').value = '';\n        userPasswordForm.querySelector('#password-confirm').value = '';\n    });\n    if (bookTourBtn) bookTourBtn.addEventListener('click', async (e)=>{\n        e.target.textContent = 'Processing...';\n        const tourId = e.target.dataset.tourId;\n        await (0, $bd6da4746eaeec83$export$8d5bdbf26681c0c2)(tourId);\n        e.target.textContent = 'Book tour now!';\n    });\n};\ndocument.addEventListener('DOMContentLoaded', $9abd65d1c0e6ac42$var$init);\n\n\n//# sourceMappingURL=index.js.map\n","/* eslint-disable */\nimport { displayMap } from './leaflet';\nimport { login, logout } from './login';\nimport { bookTour } from './stripe';\nimport { updateSettings } from './updateSettings';\n\nconst init = () => {\n  // Iinit map\n  const map = document.getElementById('map');\n  const userLoginForm = document.querySelector('.user-login-form');\n  const logoutBtn = document.querySelector('.nav__el--logout');\n  const userDataForm = document.querySelector('.form-user-data');\n  const userPasswordForm = document.querySelector('.form-user-settings');\n  const bookTourBtn = document.querySelector('#book-tour');\n\n  if (map) {\n    const locations = JSON.parse(map.dataset.locations);\n    displayMap(locations);\n  }\n\n  // Login\n  if (userLoginForm) {\n    userLoginForm.addEventListener('submit', (e) => {\n      e.preventDefault();\n\n      const email = document.querySelector('#email').value;\n      const password = document.querySelector('#password').value;\n\n      login(email, password);\n    });\n  }\n\n  // Lgout\n  if (logoutBtn) {\n    logoutBtn.addEventListener('click', () => {\n      logout();\n    });\n  }\n\n  // updata user settings\n  if (userDataForm)\n    userDataForm.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const form = new FormData();\n\n      form.append('name', document.getElementById('name').value);\n      form.append('email', document.getElementById('email').value);\n      form.append('photo', document.getElementById('photo').files[0]);\n\n      document.querySelector('.btn--save-settings').textContent = 'Updating...';\n\n      await updateSettings(form, 'data');\n\n      document.querySelector('.btn--save-settings').textContent =\n        'Save settings';\n    });\n\n  if (userPasswordForm)\n    userPasswordForm.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      userPasswordForm.querySelector('.btn--save-password').textContent =\n        'Updating...';\n\n      const passwordCurrent =\n        userPasswordForm.querySelector('#password-current').value;\n      const password = userPasswordForm.querySelector('#password').value;\n      const passwordConfirm =\n        userPasswordForm.querySelector('#password-confirm').value;\n      await updateSettings(\n        { passwordCurrent, password, passwordConfirm },\n        'password',\n      );\n\n      userPasswordForm.querySelector('.btn--save-password').textContent =\n        'Save password';\n      userPasswordForm.querySelector('#password-current').value = '';\n      userPasswordForm.querySelector('#password').value = '';\n      userPasswordForm.querySelector('#password-confirm').value = '';\n    });\n\n  if (bookTourBtn) {\n    bookTourBtn.addEventListener('click', async (e) => {\n      e.target.textContent = 'Processing...';\n      const tourId = e.target.dataset.tourId;\n      await bookTour(tourId);\n      e.target.textContent = 'Book tour now!';\n    });\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', init);\n","/* eslint-disable */\nexport const displayMap = (locations) => {\n  const map = L.map('map', {\n    zoomControl: false,\n    scrollWheelZoom: true,\n    doubleClickZoom: false,\n    dragging: true,\n  });\n\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n    attribution:\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  }).addTo(map);\n\n  const greenIcon = L.icon({\n    iconUrl: '/img/pin.png',\n    iconSize: [32, 40],\n    iconAnchor: [16, 45],\n    popupAnchor: [0, -50],\n  });\n\n  const points = [];\n\n  locations.forEach((loc) => {\n    points.push([loc.coordinates[1], loc.coordinates[0]]);\n    L.marker([loc.coordinates[1], loc.coordinates[0]], { icon: greenIcon })\n      .addTo(map)\n      .bindPopup(`<p>Day ${loc.day}: ${loc.description}</p>`, {\n        autoClose: false,\n        className: 'mapPopup',\n      })\n      .on('mouseover', function (e) {\n        this.openPopup();\n      })\n      .on('mouseout', function (e) {\n        this.closePopup();\n      })\n      .openPopup();\n  });\n\n  const bounds = L.latLngBounds(points).pad(0.5);\n\n  map.fitBounds(bounds);\n};\n","/* eslint-disable */\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n  try {\n    const res = await axios.post('/api/v1/users/login', {\n      email,\n      password,\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully!');\n\n      window.setTimeout(() => (window.location.href = '/'), 500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios.get('/api/v1/users/logout');\n\n    if ((res.data.status = 'success')) location.assign('/');\n  } catch (err) {\n    showAlert('error', 'Error logging out! Try again.');\n  }\n};\n","/* eslint-disable */\n\nexport const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","/*eslint-disable*/\n\nimport { showAlert } from './alerts';\n\nexport const bookTour = async (tourId) => {\n  try {\n    const res = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n\n    const { url } = res.data.session;\n\n    if (res.data.status === 'success') {\n      window.location.href = url;\n    } else {\n      showAlert('error', 'Invalid session or missing URL');\n    }\n  } catch (err) {\n    showAlert('error', 'Error Checking out');\n  }\n};\n","/* eslint-disable */\nimport { showAlert } from './alerts';\n\n// type is either 'password' or 'data'\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/users/update-password'\n        : '/api/v1/users/update-user';\n\n    const res = await axios.patch(url, data);\n\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n"],"names":["$eb9b3d82609c297a$export$4c5dd147b21b9176","locations","map","L","zoomControl","scrollWheelZoom","doubleClickZoom","dragging","tileLayer","attribution","addTo","greenIcon","icon","iconUrl","iconSize","iconAnchor","popupAnchor","points","forEach","loc","push","coordinates","marker","bindPopup","day","description","autoClose","className","on","e","openPopup","closePopup","bounds","latLngBounds","pad","fitBounds","$1b898bf38035b943$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$1b898bf38035b943$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$c3c64160fa6c26e4$export$596d806903d1f59e","email","password","res","axios","post","data","status","location","href","err","response","message","$c3c64160fa6c26e4$export$a0973bcfe11b05c9","get","assign","$bd6da4746eaeec83$export$8d5bdbf26681c0c2","tourId","url","session","$3ed33bdc2a0cf15d$export$f558026a994b6051","patch","toUpperCase","$9abd65d1c0e6ac42$var$init","getElementById","userLoginForm","logoutBtn","userDataForm","userPasswordForm","bookTourBtn","JSON","parse","dataset","addEventListener","preventDefault","value","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}